# Tray Mount Example - 2x2 Keyboard
# PCB secured to bottom housing via screw-in posts
# Simple, cost-effective, standardized mounting

meta:
  engine: 4.1.0
  name: tray_mount_example
  version: 1.0

units:
  kx: 19.05
  ky: 19.05
  # Minimalistic case parameters
  case_wall: 2.0
  case_height: 8 # Low profile

points:
  zones:
    matrix:
      key:
        padding: ky
        spread: kx
        tags: [key]
      columns:
        col0:
        col1:
      rows:
        row0:
        row1:

outlines:
  # PCB outline
  board:
    - what: polygon
      operation: stack
      fillet: 2
      points:
        - ref: matrix_col0_row0
          shift: [-10, -10]
        - ref: matrix_col1_row0
          shift: [10, -10]
        - ref: matrix_col1_row1
          shift: [10, 10]
        - ref: matrix_col0_row1
          shift: [-10, 10]

  # Minimalistic case outline
  case_outline:
    - what: polygon
      operation: stack
      fillet: 2
      points:
        - ref: matrix_col0_row0
          shift: [-12, -12]
        - ref: matrix_col1_row0
          shift: [12, -12]
        - ref: matrix_col1_row1
          shift: [12, 12]
        - ref: matrix_col0_row1
          shift: [-12, 12]

  # Switch plate with cutouts
  switch_plate:
    - what: polygon
      operation: stack
      fillet: 1
      points:
        - ref: matrix_col0_row0
          shift: [-10, -10]
        - ref: matrix_col1_row0
          shift: [10, -10]
        - ref: matrix_col1_row1
          shift: [10, 10]
        - ref: matrix_col0_row1
          shift: [-10, 10]
    # Subtract switch cutouts
    - what: rectangle
      where: [key]
      size: [14, 14] # MX switch cutout
      operation: subtract
    # Subtract mounting holes - better positioned
    - what: circle
      radius: 1.1
      where: matrix_col0_row0
      adjust:
        shift: [kx/2, ky/2] # Center between all 4 keys
      operation: subtract
    - what: circle
      radius: 1.1
      where: matrix_col0_row0
      adjust:
        shift: [-12, -12] # Bottom left corner
      operation: subtract
    - what: circle
      radius: 1.1
      where: matrix_col1_row1
      adjust:
        shift: [12, 12] # Top right corner
      operation: subtract

  # Screw holes (smaller, for clearance)
  screw_holes:
    - what: circle
      radius: 1.1 # M2 screw clearance
      where: matrix_col0_row0
      adjust:
        shift: [kx/2, ky/2] # Center
    - what: circle
      radius: 1.1
      where: matrix_col0_row0
      adjust:
        shift: [-12, -12] # Bottom left
    - what: circle
      radius: 1.1
      where: matrix_col1_row1
      adjust:
        shift: [12, 12] # Top right

  # Standoff posts (larger, for support)
  standoff_posts:
    - what: circle
      radius: 2.5 # Larger posts for support
      where: matrix_col0_row0
      adjust:
        shift: [kx/2, ky/2] # Center
    - what: circle
      radius: 2.5
      where: matrix_col0_row0
      adjust:
        shift: [-12, -12] # Bottom left
    - what: circle
      radius: 2.5
      where: matrix_col1_row1
      adjust:
        shift: [12, 12] # Top right

cases:
  # Switch plate
  plate:
    - name: switch_plate
      extrude: 1.6

  # Minimalistic tray mount case
  tray_case:
    # Bottom base
    - name: case_outline
      extrude: 1
    # Thin walls
    - name: case_outline
      extrude: case_height
    - name: board
      extrude: case_height
      operation: subtract
    # Standoff posts
    - name: standoff_posts
      extrude: 4
      operation: add
    # Screw holes
    - name: screw_holes
      extrude: case_height
      operation: subtract

pcbs:
  main:
    outlines:
      main:
        outline: board
