# Plateless Mount Example - 2x2 Keyboard
# No plate - switches mount directly to PCB
# Unique elastic feel, requires precise PCB design

meta:
  engine: 4.1.0
  name: plateless_mount_example
  version: 1.0

units:
  # Standard MX key spacing
  kx: 19.05
  ky: 19.05
  
  # Minimalistic cars
  case_wall: 2.0
  case_height: 10
  pcb_thickness: 3.2  # Reinforced PCB
  
  # Mounting parameters
  mount_hole_diameter: 2.2

points:
  zones:
    matrix:
      anchor:
        shift: [50, -50]
      key:
        padding: ky
        spread: kx
        tags: [key, switch]
      columns:
        col0:
          key.column_net: col0
        col1:
          key.column_net: col1
      rows:
        row0:
          row_net: row0
        row1:
          row_net: row1
    
    # PCB mounting points (more needed for stability)
    pcb_mounts:
      anchor:
        ref: matrix_col0_row0
        shift: [-kx/2, ky/2]
      key:
        tags: [pcb_mount]
      columns:
        mount_left:
        mount_right:
          key.shift: [kx, 0]
        # Additional center mounts for PCB support
        mount_center:
          key.shift: [kx/2, 0]
      rows:
        top_mounts:
        bottom_mounts:
          shift: [0, -ky]

outlines:
  # Reinforced PCB outline (no separate plate)
  pcb_outline:
    - what: rectangle
      where: [switch]
      bound: true
      size: [kx, ky]
      fillet: 2
    # PCB mounting holes
    - what: circle
      where: [pcb_mount]
      radius: mount_hole_diameter/2
      operation: subtract
  
  # Case with PCB support ledge
  case_bottom:
    - what: outline
      name: pcb_outline
      expand: case_wall
      fillet: 2

  # PCB support ledge
  pcb_ledge:
    - what: outline
      name: pcb_outline
      expand: 1

cases:
  # No separate plate - switches mount to PCB
  
  # Plateless mount case with PCB support
  plateless_mount_case:
    # Bottom case with PCB ledge
    - name: case_bottom
      extrude: case_height - pcb_thickness
    # PCB support ledge
    - name: pcb_ledge
      extrude: 1
      shift: [0, 0, case_height - pcb_thickness - 1]
      operation: add
    
    # Minimalistic top case
    - name: case_bottom
      extrude: 2
      shift: [0, 0, case_height - 2]
      operation: add
    
    # PCB mounting holes
    - what: circle
      where: [pcb_mount]
      radius: mount_hole_diameter/2
      extrude: case_height + 1
      operation: subtract

pcbs:
  plateless_pcb:
    outlines:
      main:
        outline: pcb_outline
    footprints:
      # 5-pin switches for better PCB stability
      switches:
        what: mx
        where: [switch]
        params:
          hotswap: false  # Soldered for better support
          from: "{{column_net}}"
          to: "{{colrow}}"
      pcb_mounts:
        what: mounting_hole
        where: [pcb_mount]
        params:
          drill: mount_hole_diameter